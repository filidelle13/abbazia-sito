// Traduzioni complete con i tuoi testi
const content = {
  it: {
    section1: {
      title: "Storia",
      text: "Secondo la tradizione la chiesa sorse nel luogo dove nacque Siro, vescovo di Genova nel IV sec. Non si può fissare una data precisa per l’edificazione, ma nel 1025, il vescovo Landolfo la consegnò ai monaci benedettini: ecco il motivo per cui quest’anno celebriamo il millenario.",
      image: "images/abbazia.jpg"
    },
    section2: {
      title: "Interni",
      text: "La pianta basilicale senza transetto è a 3 navate. Ci sono 11 colonne di circa 4 m di altezza che dividono lo spazio in 3 navate. In fondo troviamo una colonna più robusta che sostiene il campanile. Nelle tredici monofore sono state inserite le vetrate di Ilario Cuoghi, artista che ha realizzato anche il portale maggiore e le sculture per la Via Crucis. Il soffitto della navata centrale è una capriata in legno di Corsica del 1923.",
      image: "images/interni.jpg"
    },
    section3: {
      title: "Facciata",
      text: "La facciata evidenzia la ripartizione interna in tre navate, con un unico ingresso centrale e un semplice portale. Orientata verso Est, ha forma a salienti con quattro falde del tetto e presenta elementi tipici dell’architettura romanica: arcatelle, rosone e pavimentazione a ciottoli (risseu).",
      image: "images/facciata.jpg"
    },
    section4: {
      title: "Retro",
      text: "Il campanile è robusto e slanciato, alto più di 30 metri, ha pianta quadrata con tetto piramidale ed è basato sull’ultima campata della navata di destra. Nella cella campanaria si aprono trifore e sotto una bifora. Sul retro si vedono le tre absidi.",
      image: "images/retro.jpg"
    },
    section5: {
      title: "Polittico di San Siro",
      text: "Opera d’arte notevole è il Polittico di San Siro, realizzato nel 1516 da Pier Francesco Sacchi detto il Pavese. Restaurato nel 1960. Il santo è rappresentato in trono, benedicente, con il pastorale che schiaccia il Basilisco (simbolo dell’eresia ariana). Intorno, 8 scene della sua vita e vocazione, sovrastate dal busto della Vergine che allatta il Santo bambino.",
      image: "images/polittico.jpg"
    },
    menuLanguage: "Lingua",
    menuAbbey: "L'abbazia",
    langIt: "Italiano",
    langEn: "Inglese",
    langEs: "Spagnolo",
    section1Name: "Storia",
    section2Name: "Interni",
    section3Name: "Facciata",
    section4Name: "Retro",
    section5Name: "Polittico"
  },
  en: {
    section1: {
      title: "History",
      text: "According to tradition, the church was built on the site where Siro, bishop of Genoa, was born in the 4th century. There is no precise date for the construction, but in 1025 Bishop Landolfo handed it over to the Benedictine monks, which is why this year we celebrate the millennium.",
      image: "images/abbazia.jpg"
    },
    section2: {
      title: "Interior",
      text: "The basilical plan, without transept, has 3 aisles. There are 11 columns about 4 m high dividing the space into 3 aisles. At the end a more robust column supports the bell tower. In thirteen single-lancet windows there are stained glasses by Ilario Cuoghi, who also made the main portal and sculptures for the Stations of the Cross. The ceiling of the central nave is a wooden truss from Corsica dating back to 1923.",
      image: "images/interni.jpg"
    },
    section3: {
      title: "Facade",
      text: "The facade shows the internal division into three aisles, with a single central entrance and a simple portal. Facing east, it has a gable shape with four roof slopes and typical Romanesque elements: small arches, rose window and pebble pavement (risseu).",
      image: "images/facciata.jpg"
    },
    section4: {
      title: "Back",
      text: "The bell tower is sturdy and slender, over 30 meters high, with a square plan and pyramidal roof, resting on the last bay of the right nave. The bell cell has triple windows and below a double window. At the back the three apses can be seen.",
      image: "images/retro.jpg"
    },
    section5: {
      title: "Polyptych of San Siro",
      text: "A remarkable artwork is the Polyptych of San Siro, made in 1516 by Pier Francesco Sacchi, called the Pavese. Restored in 1960. The saint is represented enthroned, blessing, with the pastoral staff crushing the Basilisk (symbol of Arian heresy). Around, 8 scenes of his life and vocation, topped by the bust of the Virgin nursing the Holy Child.",
      image: "images/polittico.jpg"
    },
    menuLanguage: "Language",
    menuAbbey: "The Abbey",
    langIt: "Italian",
    langEn: "English",
    langEs: "Spanish",
    section1Name: "History",
    section2Name: "Interior",
    section3Name: "Facade",
    section4Name: "Back",
    section5Name: "Polyptych"
  },
  es: {
    section1: {
      title: "Historia",
      text: "Según la tradición, la iglesia fue construida en el lugar donde nació Siro, obispo de Génova en el siglo IV. No hay fecha precisa de construcción, pero en 1025 el obispo Landolfo la entregó a los monjes benedictinos, por lo que este año celebramos el milenario.",
      image: "images/abbazia.jpg"
    },
    section2: {
      title: "Interiores",
      text: "La planta basilical sin transepto tiene 3 naves. Hay 11 columnas de aproximadamente 4 m de altura que dividen el espacio en 3 naves. Al final, una columna más robusta sostiene el campanario. En trece ventanas ojivales hay vitrales de Ilario Cuoghi, quien también hizo el portal principal y las esculturas del Vía Crucis. El techo de la nave central es una armadura de madera de Córcega de 1923.",
      image: "images/interni.jpg"
    },
    section3: {
      title: "Fachada",
      text: "La fachada muestra la división interna en tres naves, con una sola entrada central y un portal simple. Orientada al este, tiene forma a dos aguas con cuatro faldones de techo y elementos típicos románicos: arcos pequeños, rosetón y pavimento de guijarros (risseu).",
      image: "images/facciata.jpg"
    },
    section4: {
      title: "Parte trasera",
      text: "El campanario es robusto y delgado, de más de 30 metros de altura, con planta cuadrada y techo piramidal, apoyado en la última bóveda de la nave derecha. La celda de las campanas tiene triforas y debajo una bifora. En la parte trasera se ven los tres ábsides.",
      image: "images/retro.jpg"
    },
    section5: {
      title: "Políptico de San Siro",
      text: "Una obra destacada es el Políptico de San Siro, realizado en 1516 por Pier Francesco Sacchi, llamado el Pavese. Restaurado en 1960. El santo está representado entronizado, bendiciendo, con el báculo aplastando al Basilisco (símbolo de la herejía aria). Alrededor, 8 escenas de su vida y vocación, coronadas por el busto de la Virgen amamantando al Niño Santo.",
      image: "images/polittico.jpg"
    },
    menuLanguage: "Idioma",
    menuAbbey: "La Abadía",
    langIt: "Italiano",
    langEn: "Inglés",
    langEs: "Español",
    section1Name: "Historia",
    section2Name: "Interiores",
    section3Name: "Fachada",
    section4Name: "Parte trasera",
    section5Name: "Políptico"
  }
};

// Stato iniziale
let currentLanguage = 'it';
let currentSection = 'section1';

// Riferimenti DOM
const menuToggleBtn = document.getElementById('menuToggle');
const sidebar = document.getElementById('sidebar');
const sectionsMenu = document.getElementById('sectionsMenu');
const langMenu = document.getElementById('langMenu');
const mainContent = document.getElementById('mainContent');

// Funzione per creare bottoni delle sezioni
function createSectionsMenu() {
  sectionsMenu.innerHTML = ''; // reset
  for(let i=1; i<=5; i++) {
    const btn = document.createElement('button');
    btn.type = 'button';
    btn.className = 'section-btn';
    btn.dataset.section = `section${i}`;
    btn.textContent = content[currentLanguage][`section${i}Name`];
    if(`section${i}` === currentSection) {
      btn.style.fontWeight = 'bold';
    }
    btn.addEventListener('click', () => {
      currentSection = btn.dataset.section;
      renderContent();
      updateSectionsMenuHighlight();
      // Chiudi menu su mobile
      sidebar.classList.remove('visible');
      menuToggleBtn.setAttribute('aria-expanded', 'false');
      sidebar.setAttribute('aria-hidden', 'true');
    });
    sectionsMenu.appendChild(btn);
  }
}

// Funzione per creare bottoni delle lingue
function createLangMenu() {
  langMenu.innerHTML = ''; // reset

  const languages = [
    {code:'it', label: content[currentLanguage].langIt},
    {code:'en', label: content[currentLanguage].langEn},
    {code:'es', label: content[currentLanguage].langEs}
  ];

  languages.forEach(lang => {
    const btn = document.createElement('button');
    btn.type = 'button';
    btn.className = 'lang-btn';
    btn.dataset.lang = lang.code;
    btn.textContent = lang.label;

    if(lang.code === currentLanguage){
      btn.style.fontWeight = 'bold';
    }

    btn.addEventListener('click', () => {
      if(lang.code !== currentLanguage) {
        currentLanguage = lang.code;
        createSectionsMenu();  // aggiorna nomi sezioni nella nuova lingua
        createLangMenu();      // aggiorna nomi lingue
        renderContent();       // render contenuto nella lingua nuova (stessa sezione)
      }
      // Chiudi menu su mobile
      sidebar.classList.remove('visible');
      menuToggleBtn.setAttribute('aria-expanded', 'false');
      sidebar.setAttribute('aria-hidden', 'true');
    });
    langMenu.appendChild(btn);
  });
}

// Aggiorna evidenziazione sezione attiva
function updateSectionsMenuHighlight() {
  document.querySelectorAll('.section-btn').forEach(btn => {
    btn.style.fontWeight = (btn.dataset.section === currentSection) ? 'bold' : 'normal';
  });
}

// Renderizza contenuto principale
function renderContent() {
  const data = content[currentLanguage][currentSection];
  if(!data) return;
  mainContent.innerHTML = `
    <h1>${data.title}</h1>
    <p>${data.text}</p>
    <img src="${data.image}" alt="${data.title}" />
  `;
  mainContent.focus();
}

// Toggle sidebar menu
menuToggleBtn.addEventListener('click', () => {
  const visible = sidebar.classList.toggle('visible');
  menuToggleBtn.setAttribute('aria-expanded', visible.toString());
  sidebar.setAttribute('aria-hidden', (!visible).toString());
});

// Inizializza la pagina
function init() {
  createSectionsMenu();
  createLangMenu();
  renderContent();
  sidebar.setAttribute('aria-hidden', 'true');
  menuToggleBtn.setAttribute('aria-expanded', 'false');
}

window.addEventListener('DOMContentLoaded', init);
